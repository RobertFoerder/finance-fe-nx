"use strict";(self.webpackChunkfinance_fe=self.webpackChunkfinance_fe||[]).push([[175],{175:(tt,Y,l)=>{l.r(Y),l.d(Y,{ROUTES:()=>k,SummaryViewsModule:()=>et});var c=l(6814),y=l(8136),f=l(6884),o=l(4221),g=l(7398),U=l(8180);const Z=(0,o.PH)("[Finance-Entries/API] Load finance entries",(0,o.Ky)()),b=(0,o.PH)("[Finance-Entries/API] Load finance entries success",(0,o.Ky)()),J=(0,o.PH)("[Finance-Entries/API] Load finance entries failure",(0,o.Ky)()),O=(0,o.PH)("[Finance-Entries] Reset"),M=(0,o.PH)("[Finance-Entries/API] Add",(0,o.Ky)()),L=(0,o.PH)("[Finance-Entries/API] Add finance entry success",(0,o.Ky)()),w=(0,o.PH)("[Finance-Entries/API] Add finance entry failure",(0,o.Ky)()),P=(0,o.PH)("[Finance-Entries] Reset add"),C=(0,o.PH)("[Finance-Entries/API] Delete",(0,o.Ky)()),R=(0,o.PH)("[Finance-Entries/API] Delete entry success",(0,o.Ky)()),I=(0,o.PH)("[Finance-Entries/API] Delete entry failure",(0,o.Ky)()),N=(0,o.PH)("[Finannce-Entries] Reset delete"),S=(0,o.PH)("[Finance-Entries/API] Edit",(0,o.Ky)()),Q=(0,o.PH)("[Finance-Entries/API] Edit entry success",(0,o.Ky)()),D=(0,o.PH)("[Finance-Entries/API] Edit entry failure",(0,o.Ky)()),H=(0,o.PH)("[Finance-Entries] Reset edit"),A=(0,o.PH)("[Selected year] set selected year",(0,o.Ky)()),$=(0,o.PH)("[Selected month] Set selected month",(0,o.Ky)());var z=l(6293);const j="financeEntries",_=(0,z.H)(),V=_.getInitialState({readRequestStatus:"initial",addRequestStatus:"initial",deleteRequestStatus:"initial",editRequestStatus:"initial",selectedYear:(new Date).getFullYear(),selectedMonth:(new Date).getMonth(),loadError:void 0,addError:void 0,deleteError:void 0,editError:void 0}),W=(0,o.Lq)(V,(0,o.on)(A,(t,{year:a})=>({...t,selectedYear:a})),(0,o.on)($,(t,{month:a})=>({...t,selectedMonth:a})),(0,o.on)(Z,t=>({...t,readRequestStatus:"pending",loadError:void 0})),(0,o.on)(b,(t,{entries:a})=>_.setAll(a,{...t,readRequestStatus:"successful"})),(0,o.on)(J,(t,{error:a})=>({...t,loadError:a,readRequestStatus:"failed"})),(0,o.on)(M,t=>({...t,addRequestStatus:"pending",addError:void 0})),(0,o.on)(L,(t,{entry:a})=>_.setOne(a,{...t,addRequestStatus:"successful"})),(0,o.on)(w,(t,{error:a})=>({...t,addRequestStatus:"failed",addError:a})),(0,o.on)(C,t=>({...t,deleteRequestStatus:"pending",deleteError:void 0})),(0,o.on)(R,(t,{id:a})=>_.removeOne(a,{...t,deleteRequestStatus:"successful"})),(0,o.on)(I,(t,{error:a})=>({...t,deleteRequestStatus:"failed",deleteError:a})),(0,o.on)(S,t=>({...t,editRequestStatus:"pending",editError:void 0})),(0,o.on)(Q,(t,{entry:a})=>_.upsertOne(a,{...t,editRequestStatus:"successful"})),(0,o.on)(D,(t,{error:a})=>({...t,editRequestStatus:"failed",editError:a})),(0,o.on)(O,t=>({...t,loadError:void 0,readRequestStatus:"initial"})),(0,o.on)(P,t=>({...t,addError:void 0,addRequestStatus:"initial"})),(0,o.on)(N,t=>({...t,deleteError:void 0,deleteRequestStatus:"initial"})),(0,o.on)(H,t=>({...t,editError:void 0,editRequestStatus:"initial"})));function X(t,a){return W(t,a)}const h=(0,o.ZF)(j),{selectAll:ee,selectEntities:te}=_.getSelectors(),ne=(0,o.P1)(h,t=>"pending"===t.readRequestStatus),ie=(0,o.P1)(h,t=>"successful"===t.readRequestStatus),se=(0,o.P1)(h,t=>t.loadError),oe=(0,o.P1)(h,t=>ee(t)),re=(0,o.P1)(h,t=>te(t)),ae=(0,o.P1)(h,t=>"pending"===t.deleteRequestStatus),de=(0,o.P1)(h,t=>t.deleteError),ce=(0,o.P1)(h,t=>"pending"===t.addRequestStatus),le=(0,o.P1)(h,t=>"successful"===t.addRequestStatus),ue=(0,o.P1)(h,t=>t.addError),pe=(0,o.P1)(h,t=>"pending"===t.editRequestStatus),he=(0,o.P1)(h,t=>"successful"===t.editRequestStatus),me=(0,o.P1)(h,t=>t.editError),ge=(0,o.P1)(h,t=>t.selectedYear),fe=(0,o.P1)(h,t=>t.selectedMonth);var e=l(9212),q=l(7280);let v=(()=>{class t{constructor(n,s){this.store=n,this.sumUp=s,this.loading$=this.store.pipe((0,o.Ys)(ne)),this.loaded$=this.store.pipe((0,o.Ys)(ie)),this.collection$=this.store.pipe((0,o.Ys)(oe)),this.entities$=this.store.pipe((0,o.Ys)(re)),this.loadError$=this.store.pipe((0,o.Ys)(se)),this.deleting$=this.store.pipe((0,o.Ys)(ae)),this.deleteError$=this.store.pipe((0,o.Ys)(de)),this.adding$=this.store.pipe((0,o.Ys)(ce)),this.added$=this.store.pipe((0,o.Ys)(le)),this.addError$=this.store.pipe((0,o.Ys)(ue)),this.editing$=this.store.pipe((0,o.Ys)(pe)),this.edited$=this.store.pipe((0,o.Ys)(he)),this.editError$=this.store.pipe((0,o.Ys)(me)),this.selectedYear$=this.store.pipe((0,o.Ys)(ge)),this.selectedMonth$=this.store.pipe((0,o.Ys)(fe)),this.total$=this.collection$.pipe((0,g.U)(i=>this.sumUp.financeEntries(i)))}init(){this.loaded$.pipe((0,U.q)(1)).subscribe(n=>{n||this.selectedYear$.pipe((0,U.q)(1)).subscribe(s=>this.store.dispatch(Z({year:s})))})}resetEntries(){this.store.dispatch(O())}resetAdd(){this.store.dispatch(P())}resetDelete(){this.store.dispatch(N())}resetEdit(){this.store.dispatch(H())}setSelectedYear(n){this.store.dispatch(A({year:n}))}setSelectedMonth(n){this.store.dispatch($({month:n}))}addEntry(n){this.store.dispatch(M({entry:n}))}deleteEntry(n){n&&this.store.dispatch(C({id:n}))}editEntry(n){n.id&&this.store.dispatch(S({id:n.id,entry:n}))}static#e=this.\u0275fac=function(s){return new(s||t)(e.LFG(o.yh),e.LFG(q.A))};static#t=this.\u0275prov=e.Yz7({token:t,factory:t.\u0275fac})}return t})();var m=l(3109),ye=l(3536),x=l(7566);let _e=(()=>{class t{constructor(n,s){this.actions$=n,this.service=s,this.load$=(0,m.GW)(()=>this.actions$.pipe((0,m.l4)(Z),(0,x.he)({run:({year:i})=>this.service.getEntries(i).pipe((0,g.U)(r=>b({entries:r}))),onError:(i,r)=>J({error:(0,f.xs)(r)})}))),this.add$=(0,m.GW)(()=>this.actions$.pipe((0,m.l4)(M),(0,x.he)({run:({entry:i})=>this.service.postEntry(i).pipe((0,g.U)(r=>L({entry:r}))),onError:(i,r)=>w({error:(0,f.xs)(r)})}))),this.delete$=(0,m.GW)(()=>this.actions$.pipe((0,m.l4)(C),(0,x.he)({run:({id:i})=>this.service.deleteEntry(i).pipe((0,g.U)(()=>R({id:i}))),onError:(i,r)=>I({error:(0,f.xs)(r)})}))),this.edit$=(0,m.GW)(()=>this.actions$.pipe((0,m.l4)(S),(0,x.he)({run:({id:i,entry:r})=>this.service.putEntry(i,r).pipe((0,g.U)(d=>Q({entry:d}))),onError:(i,r)=>D({error:(0,f.xs)(r)})}))),this.loadEntriesOnYearChanged$=(0,m.GW)(()=>this.actions$.pipe((0,m.l4)(A),(0,x.he)({run:({year:i})=>Z({year:i})}))),this.setSelectedMonthOnYearChanged$=(0,m.GW)(()=>this.actions$.pipe((0,m.l4)(A),(0,x.he)({run:({year:i})=>{let r=11;const d=new Date;return i===d.getFullYear()&&(r=d.getMonth()),$({month:r})}})))}static#e=this.\u0275fac=function(s){return new(s||t)(e.LFG(m.eX),e.LFG(ye.eJ))};static#t=this.\u0275prov=e.Yz7({token:t,factory:t.\u0275fac})}return t})();var T=l(1868);let ve=(()=>{class t{static#e=this.\u0275fac=function(s){return new(s||t)};static#t=this.\u0275mod=e.oAB({type:t});static#n=this.\u0275inj=e.cJS({providers:[v],imports:[c.ez,o.Aw.forFeature(j,X),m.sQ.forFeature([_e]),T.m]})}return t})();var K=l(1503),u=l(95),xe=l(4219);function Ee(t,a){if(1&t){const n=e.EpF();e.O4$(),e.kcU(),e.TgZ(0,"div",18)(1,"span"),e._uU(2),e.qZA(),e.TgZ(3,"button",7),e.NdJ("click",function(){const r=e.CHM(n).$implicit,d=e.oxw(3);return e.KtG(d.editEntry(r.id))}),e._UZ(4,"img",19),e.qZA(),e.TgZ(5,"button",7),e.NdJ("click",function(){const r=e.CHM(n).$implicit,d=e.oxw(3);return e.KtG(d.deleteEntry(r.id,r.description))}),e._UZ(6,"img",20),e.qZA(),e.TgZ(7,"span",21),e._uU(8),e.ALo(9,"currency"),e.qZA()()}if(2&t){const n=a.$implicit;e.xp6(2),e.Oqu(n.description),e.xp6(5),e.ekj("expense",n.value&&n.value<0)("income",n.value&&n.value>0),e.xp6(1),e.hij(" ",e.xi3(9,6,n.value,"EUR")," ")}}function Ze(t,a){if(1&t){const n=e.EpF();e.TgZ(0,"div",14)(1,"div",15)(2,"span",16),e._uU(3),e.qZA(),e.TgZ(4,"button",7),e.NdJ("click",function(){const r=e.CHM(n).$implicit,d=e.oxw(2);return e.KtG(d.addEntry(r.category))}),e.O4$(),e.TgZ(5,"svg",8)(6,"title"),e._uU(7,"Add"),e.qZA(),e._UZ(8,"path",9),e.qZA()()(),e.YNc(9,Ee,10,9,"div",17),e.qZA()}if(2&t){const n=a.$implicit;e.xp6(3),e.Oqu(n.category),e.xp6(6),e.Q6J("ngForOf",n.entries)}}function Ae(t,a){if(1&t&&(e.TgZ(0,"div",12),e.YNc(1,Ze,10,2,"div",13),e.ALo(2,"async"),e.qZA()),2&t){const n=e.oxw();e.xp6(1),e.Q6J("ngForOf",e.lcZ(2,1,n.monthlyEntriesGroupedByCategory$))}}let Te=(()=>{class t extends f.e${get month(){return this._month}set month(n){this._month=n,this.date.setDate(1),this.date.setMonth(n)}constructor(n,s,i,r,d){super(),this.facade=n,this.router=s,this.activatedRoute=i,this.confirmBox=r,this.sumUp=d,this._month=(new Date).getMonth(),this.monthlyEntries$=this.facade.collection$.pipe((0,g.U)(p=>p.filter(E=>E.month===this.month))),this.expanded$=this.facade.selectedMonth$.pipe((0,g.U)(p=>p===this._month)),this.total=0,this.date=new Date,this.monthlyEntriesGroupedByCategory$=this.monthlyEntries$.pipe((0,g.U)(p=>this.groupEntriesByCategory(p))),this.monthlyTotal$=this.monthlyEntries$.pipe((0,g.U)(p=>this.sumUp.financeEntries(p)))}ngOnInit(){this.useLatest(this.facade.selectedYear$,n=>this.date.setFullYear(n)),this.subscribeTo(this.monthlyTotal$,n=>{n&&(this.total=n)})}addEntry(n){this.facade.setSelectedMonth(this._month);let s=null;n&&(s={category:n}),this.router.navigate(["add"],{relativeTo:this.activatedRoute,queryParams:s})}toggleExpand(){this.useLatest(this.expanded$,n=>{let s;n||(s=this._month),this.facade.setSelectedMonth(s)})}deleteEntry(n,s){this.confirmBox.danger("Delete entry",`Should entry "${s}" really be deleted?`,"Yes","Cancel").subscribe(i=>{i.success&&this.facade.deleteEntry(n)})}editEntry(n){this.router.navigate(["edit",n],{relativeTo:this.activatedRoute})}groupEntriesByCategory(n){const s=[];if(!n)return s;for(const i of n){if(s.some(d=>d.category===i.category))continue;const r=n.filter(d=>d.category===i.category).sort((d,p)=>d.date&&p.date?d.date.toString().localeCompare(p.date.toString()):0);s.push({category:i.category,entries:r})}return s.sort((i,r)=>i.category&&r.category?i.category.localeCompare(r.category):0)}static#e=this.\u0275fac=function(s){return new(s||t)(e.Y36(v),e.Y36(y.F0),e.Y36(y.gz),e.Y36(xe.jL),e.Y36(q.A))};static#t=this.\u0275cmp=e.Xpm({type:t,selectors:[["finance-fe-monthly-summary"]],inputs:{month:"month"},features:[e.qOj],decls:22,vars:27,consts:[[1,"shadow-lg","rounded-md","h-auto","bg-white","flex","flex-col","p-2"],[1,"flex","flex-row","items-center","border-b-0","border-black"],[3,"click"],["viewBox","0 0 10 6",1,"h-2","w-2"],["d","M 0 0 l 5 6 l 5 -6"],["d","M 0 6 l 5 -6 l 5 6"],[1,"ml-2","text-lg","font-bold"],[1,"pl-2",3,"click"],["viewBox","0 0 20 20","xmlns","http://www.w3.org/2000/svg",1,"fill-current","h-4","w-4"],["d","M 10 8 L 10 1 L 8 1 L 8 8 l -7 0 l 0 2 L 8 10 l 0 7 l 2 -0 L 10 10 l 7 0 l -0 -2 z"],[1,"flex-grow","text-right","text-lg","font-bold"],["class","pt-4 pb-2 pl-2",4,"ngIf"],[1,"pt-4","pb-2","pl-2"],["class","mb-2",4,"ngFor","ngForOf"],[1,"mb-2"],[1,"border-b-2"],[1,"font-bold"],["class","flex",4,"ngFor","ngForOf"],[1,"flex"],["src","/assets/svg/edit.svg",1,"h-4","w-4","mr-2"],["src","/assets/svg/delete.svg",1,"h-4","w-4","mr-2"],[1,"flex-grow","text-right"]],template:function(s,i){1&s&&(e.TgZ(0,"div",0)(1,"div",1),e.ALo(2,"async"),e.TgZ(3,"button",2),e.NdJ("click",function(){return i.toggleExpand()}),e.O4$(),e.TgZ(4,"svg",3)(5,"path",4),e.ALo(6,"async"),e.qZA(),e._UZ(7,"path",5),e.ALo(8,"async"),e.qZA()(),e.kcU(),e.TgZ(9,"span",6),e._uU(10),e.ALo(11,"date"),e.qZA(),e.TgZ(12,"button",7),e.NdJ("click",function(){return i.addEntry()}),e.O4$(),e.TgZ(13,"svg",8)(14,"title"),e._uU(15,"Add"),e.qZA(),e._UZ(16,"path",9),e.qZA()(),e.kcU(),e.TgZ(17,"span",10),e._uU(18),e.ALo(19,"currency"),e.qZA()(),e.YNc(20,Ae,3,3,"div",11),e.ALo(21,"async"),e.qZA()),2&s&&(e.xp6(1),e.ekj("border-b-2",e.lcZ(2,13,i.expanded$)),e.xp6(4),e.ekj("hidden",e.lcZ(6,15,i.expanded$)),e.xp6(2),e.ekj("hidden",!1===e.lcZ(8,17,i.expanded$)),e.xp6(3),e.Oqu(e.xi3(11,19,i.date,"MMMM YYYY")),e.xp6(7),e.ekj("income",i.total>0)("expense",i.total<0),e.xp6(1),e.Oqu(e.xi3(19,22,i.total,"EUR")),e.xp6(2),e.Q6J("ngIf",e.lcZ(21,25,i.expanded$)))},dependencies:[c.sg,c.O5,c.Ov,c.H9,c.uU],encapsulation:2,changeDetection:0})}return t})(),F=(()=>{class t{transform(n){if(void 0===n)return;const s=new Date;return s.setDate(1),s.setMonth(n),s}static#e=this.\u0275fac=function(s){return new(s||t)};static#t=this.\u0275pipe=e.Yjl({name:"monthToDate",type:t,pure:!0})}return t})();function Me(t,a){if(1&t&&(e.TgZ(0,"div",21)(1,"span",22),e._uU(2),e.ALo(3,"date"),e.ALo(4,"monthToDate"),e.qZA(),e.TgZ(5,"span",23),e._uU(6),e.ALo(7,"currency"),e.qZA()()),2&t){const n=a.$implicit;e.xp6(2),e.Oqu(e.xi3(3,6,e.lcZ(4,9,n.month),"MMMM")),e.xp6(3),e.ekj("expense",n.sum&&n.sum<0)("income",n.sum&&n.sum>0),e.xp6(1),e.hij(" ",e.xi3(7,11,n.sum,"EUR")," ")}}function Ce(t,a){if(1&t&&(e.TgZ(0,"div",3),e.YNc(1,Me,8,14,"div",20),e.qZA()),2&t){const n=e.oxw().$implicit;e.xp6(1),e.Q6J("ngForOf",n.months)}}function Se(t,a){if(1&t){const n=e.EpF();e.TgZ(0,"div",15)(1,"div",16)(2,"button",5),e.NdJ("click",function(){const r=e.CHM(n).$implicit;return e.KtG(r.expanded=!r.expanded)}),e.O4$(),e.TgZ(3,"svg",6),e._UZ(4,"path",7)(5,"path",8),e.qZA()(),e.kcU(),e.TgZ(6,"span",17),e._uU(7),e.qZA(),e.TgZ(8,"span",10),e._uU(9),e.ALo(10,"currency"),e.qZA(),e.TgZ(11,"span",18),e._uU(12),e.ALo(13,"currency"),e.qZA()(),e.YNc(14,Ce,2,1,"div",19),e.qZA()}if(2&t){const n=a.$implicit;e.xp6(4),e.ekj("hidden",n.expanded),e.xp6(1),e.ekj("hidden",!n.expanded),e.xp6(2),e.Oqu(n.name),e.xp6(2),e.hij(" ",e.xi3(10,12,n.monthlyAverage,"EUR"),"/month "),e.xp6(2),e.ekj("expense",n.value&&n.value<0)("income",n.value&&n.value>0),e.xp6(1),e.hij(" ",e.xi3(13,15,n.value,"EUR")," "),e.xp6(2),e.Q6J("ngIf",n.expanded)}}function $e(t,a){if(1&t&&(e.TgZ(0,"div",13),e.YNc(1,Se,15,18,"div",14),e.qZA()),2&t){const n=e.oxw().$implicit;e.xp6(1),e.Q6J("ngForOf",n.descriptions)}}function qe(t,a){if(1&t){const n=e.EpF();e.TgZ(0,"div",3)(1,"div",4)(2,"button",5),e.NdJ("click",function(){const r=e.CHM(n).$implicit;return e.KtG(r.expanded=!r.expanded)}),e.O4$(),e.TgZ(3,"svg",6),e._UZ(4,"path",7)(5,"path",8),e.qZA()(),e.kcU(),e.TgZ(6,"span",9),e._uU(7),e.qZA(),e.TgZ(8,"span",10),e._uU(9),e.ALo(10,"currency"),e.qZA(),e.TgZ(11,"span",11),e._uU(12),e.ALo(13,"currency"),e.qZA()(),e.YNc(14,$e,2,1,"div",12),e.qZA()}if(2&t){const n=a.$implicit;e.xp6(4),e.ekj("hidden",n.expanded),e.xp6(1),e.ekj("hidden",!n.expanded),e.xp6(2),e.Oqu(n.name),e.xp6(2),e.hij(" ",e.xi3(10,12,n.monthlyAverage,"EUR"),"/month "),e.xp6(2),e.ekj("expense",n.value&&n.value<0)("income",n.value&&n.value>0),e.xp6(1),e.hij(" ",e.xi3(13,15,n.value,"EUR")," "),e.xp6(2),e.Q6J("ngIf",n.expanded)}}let Fe=(()=>{class t extends f.e${constructor(n,s,i){super(),this.facade=n,this.sumUp=s,this.dateService=i,this.availableMonths=0,this.entriesGroupedByCategory$=this.facade.collection$.pipe((0,g.U)(r=>this.groupEntriesByCategory(r)))}ngOnInit(){this.subscribeTo(this.facade.selectedYear$,n=>this.availableMonths=this.dateService.getAvailableMonths(n).length)}groupEntriesByCategory(n){const s=[],i=n.map(r=>r.category?.trim()).filter(this.distinct);for(const r of i){const d=n.filter(E=>E.category?.trim()===r),p=this.sumUp.financeEntries(d);s.push({name:r,value:p,descriptions:this.groupEntriesByDescription(d),expanded:!1,monthlyAverage:this.getMonthlyAverage(p)})}return s.sort((r,d)=>r.name&&d.name?r.name.localeCompare(d.name):0)}groupEntriesByDescription(n){const s=[],i=n.map(r=>r.description?.trim()).filter(this.distinct);for(const r of i){const d=n.filter(E=>E.description?.trim()===r),p=this.sumUp.financeEntries(d);s.push({name:r,value:p,monthlyAverage:this.getMonthlyAverage(p),expanded:!1,months:this.groupEntriesByMonth(d)})}return s.sort((r,d)=>r.name&&d.name?r.name.localeCompare(d.name):0)}groupEntriesByMonth(n){const s=[];for(let i=0;i<12;i++){const r=n.filter(d=>d.month===i);r.length>0&&s.push({month:i,sum:this.sumUp.financeEntries(r)})}return s}getMonthlyAverage(n){return n?n/this.availableMonths:0}distinct(n,s,i){return i.indexOf(n)===s}static#e=this.\u0275fac=function(s){return new(s||t)(e.Y36(v),e.Y36(q.A),e.Y36(K.R))};static#t=this.\u0275cmp=e.Xpm({type:t,selectors:[["finance-fe-category-summary"]],features:[e.qOj],decls:4,vars:3,consts:[[1,"shadow-lg","rounded-md","h-auto","bg-white","flex","flex-col","p-2"],[1,"pb-2","pl-2"],["class","mb-2",4,"ngFor","ngForOf"],[1,"mb-2"],[1,"border-b-2","flex"],[3,"click"],["viewBox","0 0 10 6",1,"h-2","w-2"],["d","M 0 0 l 5 6 l 5 -6"],["d","M 0 6 l 5 -6 l 5 6"],[1,"ml-2","font-bold"],[1,"average"],[1,"value","font-bold"],["class","mb-4",4,"ngIf"],[1,"mb-4"],["class","pl-2",4,"ngFor","ngForOf"],[1,"pl-2"],[1,"flex","border-b-2"],[1,"ml-2"],[1,"value"],["class","mb-2",4,"ngIf"],["class","flex",4,"ngFor","ngForOf"],[1,"flex"],[1,"text-sm"],[1,"flex-grow","text-right","text-sm"]],template:function(s,i){1&s&&(e.TgZ(0,"div",0)(1,"div",1),e.YNc(2,qe,15,18,"div",2),e.ALo(3,"async"),e.qZA()()),2&s&&(e.xp6(2),e.Q6J("ngForOf",e.lcZ(3,1,i.entriesGroupedByCategory$)))},dependencies:[c.sg,c.O5,c.Ov,c.H9,c.uU,F],styles:[".value[_ngcontent-%COMP%]{min-width:7rem;text-align:right}.average[_ngcontent-%COMP%]{flex-grow:1;align-self:center;text-align:right;font-size:.875rem;line-height:1.25rem}"],changeDetection:0})}return t})();function Ye(t,a){if(1&t&&(e.TgZ(0,"option",8),e._uU(1),e.qZA()),2&t){const n=a.$implicit;e.Q6J("ngValue",n),e.xp6(1),e.hij(" ",n," ")}}function Ue(t,a){1&t&&(e.TgZ(0,"span"),e._uU(1,"Loading ..."),e.qZA())}function be(t,a){1&t&&(e.TgZ(0,"span"),e._uU(1,"Error loading entries..."),e.qZA())}function Je(t,a){1&t&&(e.TgZ(0,"span"),e._uU(1,"Deleting..."),e.qZA())}function Oe(t,a){1&t&&(e.TgZ(0,"span"),e._uU(1,"Error deleting entry..."),e.qZA())}function Le(t,a){if(1&t&&(e.TgZ(0,"div",14),e._UZ(1,"finance-fe-monthly-summary",15),e.qZA()),2&t){const n=a.$implicit;e.xp6(1),e.Q6J("month",n)}}function we(t,a){if(1&t&&(e.TgZ(0,"div"),e.YNc(1,Le,2,1,"div",13),e.ALo(2,"async"),e.qZA()),2&t){const n=e.oxw(2);e.xp6(1),e.Q6J("ngForOf",e.lcZ(2,1,n.availableMonths$))}}function Pe(t,a){1&t&&(e.TgZ(0,"div",14),e._UZ(1,"finance-fe-category-summary"),e.qZA())}function Re(t,a){if(1&t&&(e.TgZ(0,"div"),e.YNc(1,we,3,3,"div",7)(2,Pe,2,0,"div",9),e.TgZ(3,"div",10)(4,"span",11),e._uU(5),e.ALo(6,"currency"),e.qZA(),e.TgZ(7,"span",12),e._uU(8,"Total"),e.qZA()()()),2&t){const n=e.oxw();e.xp6(1),e.Q6J("ngIf","month"===n.displayType),e.xp6(1),e.Q6J("ngIf","category"===n.displayType),e.xp6(2),e.ekj("income",n.total>0)("expense",n.total<0),e.xp6(1),e.Oqu(e.xi3(6,7,n.total,"EUR"))}}let Ie=(()=>{class t extends f.e${constructor(n,s){super(),this.facade=n,this.dateService=s,this.year=(new Date).getFullYear(),this.availableYears=[],this.availableMonths$=this.facade.selectedYear$.pipe((0,g.U)(i=>this.dateService.getAvailableMonths(i))),this.total=0,this.displayType="month"}ngOnInit(){this.loadAvailableYears(),this.subscribeTo(this.facade.total$,n=>{n&&(this.total=n)}),this.useLatest(this.facade.selectedYear$,n=>this.year=n),this.facade.init()}selectedYearChanged(n){this.facade.setSelectedYear(n),this.year=n}loadAvailableYears(){const n=(new Date).getFullYear();for(let s=n;s>=n-100;s--)this.availableYears.push(s)}static#e=this.\u0275fac=function(s){return new(s||t)(e.Y36(v),e.Y36(K.R))};static#t=this.\u0275cmp=e.Xpm({type:t,selectors:[["ng-component"]],features:[e.qOj],decls:23,vars:22,consts:[["for","year"],["name","year",1,"ml-1",3,"ngModel","ngModelChange"],[3,"ngValue",4,"ngFor","ngForOf"],["for","displayType",1,"ml-2"],["name","displayType",1,"ml-1",3,"ngModel","ngModelChange"],["value","month"],["value","category"],[4,"ngIf"],[3,"ngValue"],["class","mt-2",4,"ngIf"],[1,"mt-2","mr-2","flex","flex-row-reverse"],[1,"text-lg","font-bold"],[1,"font-bold","mr-2","text-lg"],["class","mt-2",4,"ngFor","ngForOf"],[1,"mt-2"],[3,"month"]],template:function(s,i){1&s&&(e.TgZ(0,"label",0),e._uU(1,"Year"),e.qZA(),e.TgZ(2,"select",1),e.NdJ("ngModelChange",function(d){return i.selectedYearChanged(d)}),e.YNc(3,Ye,2,2,"option",2),e.qZA(),e.TgZ(4,"label",3),e._uU(5,"Display by"),e.qZA(),e.TgZ(6,"select",4),e.NdJ("ngModelChange",function(d){return i.displayType=d}),e.TgZ(7,"option",5),e._uU(8,"month"),e.qZA(),e.TgZ(9,"option",6),e._uU(10,"category"),e.qZA()(),e.YNc(11,Ue,2,0,"span",7),e.ALo(12,"async"),e.YNc(13,be,2,0,"span",7),e.ALo(14,"async"),e.YNc(15,Je,2,0,"span",7),e.ALo(16,"async"),e.YNc(17,Oe,2,0,"span",7),e.ALo(18,"async"),e.YNc(19,Re,9,10,"div",7),e.ALo(20,"async"),e.ALo(21,"async"),e.ALo(22,"async")),2&s&&(e.xp6(2),e.Q6J("ngModel",i.year),e.xp6(1),e.Q6J("ngForOf",i.availableYears),e.xp6(3),e.Q6J("ngModel",i.displayType),e.xp6(5),e.Q6J("ngIf",e.lcZ(12,8,i.facade.loading$)),e.xp6(2),e.Q6J("ngIf",e.lcZ(14,10,i.facade.loadError$)),e.xp6(2),e.Q6J("ngIf",e.lcZ(16,12,i.facade.deleting$)),e.xp6(2),e.Q6J("ngIf",e.lcZ(18,14,i.facade.deleteError$)),e.xp6(2),e.Q6J("ngIf",!1===e.lcZ(20,16,i.facade.loading$)&&void 0===e.lcZ(21,18,i.facade.loadError$)&&!1===e.lcZ(22,20,i.facade.deleting$)))},dependencies:[c.sg,c.O5,u.YN,u.Kr,u.EJ,u.JJ,u.On,Te,Fe,c.Ov,c.H9],encapsulation:2,changeDetection:0})}return t})(),Ne=(()=>{class t{static#e=this.\u0275fac=function(s){return new(s||t)};static#t=this.\u0275mod=e.oAB({type:t});static#n=this.\u0275inj=e.cJS({imports:[c.ez,u.u5,T.m]})}return t})();var G=l(8763),B=l(4954);function Qe(t,a){1&t&&(e.TgZ(0,"span"),e._uU(1,"Adding..."),e.qZA())}function De(t,a){if(1&t){const n=e.EpF();e.TgZ(0,"form",2,3),e.NdJ("ngSubmit",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.facade.addEntry(i.entry))}),e.TgZ(2,"div")(3,"label",4),e._uU(4,"Year"),e.qZA(),e._UZ(5,"input",5),e.qZA(),e.TgZ(6,"div")(7,"label",6),e._uU(8,"Month"),e.qZA(),e._UZ(9,"input",7),e.ALo(10,"date"),e.ALo(11,"monthToDate"),e.qZA(),e.TgZ(12,"div")(13,"label",8),e._uU(14,"Category*"),e.qZA(),e.TgZ(15,"input",9),e.NdJ("ngModelChange",function(i){e.CHM(n);const r=e.oxw();return e.KtG(r.entry.category=i)}),e.qZA()(),e.TgZ(16,"div")(17,"label",10),e._uU(18,"Description*"),e.qZA(),e.TgZ(19,"input",11),e.NdJ("ngModelChange",function(i){e.CHM(n);const r=e.oxw();return e.KtG(r.entry.description=i)}),e.qZA()(),e.TgZ(20,"div")(21,"label",12),e._uU(22,"Value*"),e.qZA(),e.TgZ(23,"finance-fe-value-input",13),e.NdJ("ngModelChange",function(i){e.CHM(n);const r=e.oxw();return e.KtG(r.entry.value=i)}),e.qZA()(),e.TgZ(24,"div")(25,"button",14),e._uU(26," Add entry "),e.qZA()()()}if(2&t){const n=e.MAs(1),s=e.oxw();e.xp6(5),e.Q6J("ngModel",s.entry.year),e.xp6(4),e.Q6J("ngModel",e.xi3(10,6,e.lcZ(11,9,s.entry.month),"MMMM")),e.xp6(6),e.Q6J("ngModel",s.entry.category),e.xp6(4),e.Q6J("ngModel",s.entry.description),e.xp6(4),e.Q6J("ngModel",s.entry.value),e.xp6(2),e.Q6J("disabled",n.form.untouched||!n.form.valid)}}let He=(()=>{class t extends f.e${constructor(n,s,i,r){super(),this.facade=n,this.router=s,this.activatedRoute=i,this.toastr=r,this.entry={month:(new Date).getMonth(),category:"",description:"",date:new Date}}ngOnInit(){this.facade.resetAdd(),this.entry.category=this.activatedRoute.snapshot.queryParams.category,this.useLatest(this.facade.selectedYear$,n=>this.entry.year=n),this.useLatest(this.facade.selectedMonth$,n=>this.entry.month=n),this.subscribeTo(this.facade.addError$,n=>{n&&this.toastr.error("Error adding entry")}),this.subscribeTo(this.facade.added$,n=>{n&&this.router.navigate(["/summary"])})}static#e=this.\u0275fac=function(s){return new(s||t)(e.Y36(v),e.Y36(y.F0),e.Y36(y.gz),e.Y36(G._W))};static#t=this.\u0275cmp=e.Xpm({type:t,selectors:[["ng-component"]],features:[e.qOj],decls:4,vars:6,consts:[[4,"ngIf"],["class","max-w-md",3,"ngSubmit",4,"ngIf"],[1,"max-w-md",3,"ngSubmit"],["entryForm","ngForm"],["for","year"],["name","year","type","text","readonly","",3,"ngModel"],["for","month"],["name","month","type","text","readonly","",3,"ngModel"],["for","category"],["name","category","type","text","required","",3,"ngModel","ngModelChange"],["for","description"],["name","description","type","text","required","",3,"ngModel","ngModelChange"],["for","value"],["name","value","required","",3,"ngModel","ngModelChange"],["type","submit",1,"btn-primary","mt-2",3,"disabled"]],template:function(s,i){1&s&&(e.YNc(0,Qe,2,0,"span",0),e.ALo(1,"async"),e.YNc(2,De,27,11,"form",1),e.ALo(3,"async")),2&s&&(e.Q6J("ngIf",e.lcZ(1,2,i.facade.adding$)),e.xp6(2),e.Q6J("ngIf",!1===e.lcZ(3,4,i.facade.adding$)))},dependencies:[c.O5,B.o,u._Y,u.Fj,u.JJ,u.JL,u.Q7,u.On,u.F,c.Ov,c.uU,F],encapsulation:2,changeDetection:0})}return t})(),je=(()=>{class t{static#e=this.\u0275fac=function(s){return new(s||t)};static#t=this.\u0275mod=e.oAB({type:t});static#n=this.\u0275inj=e.cJS({imports:[c.ez,T.m,u.u5]})}return t})(),Ke=(()=>{class t{static#e=this.\u0275fac=function(s){return new(s||t)};static#t=this.\u0275mod=e.oAB({type:t});static#n=this.\u0275inj=e.cJS({imports:[c.ez,u.u5,T.m]})}return t})();var Ge=l(812),Be=l(9397),ke=l(4664);function ze(t,a){1&t&&(e.TgZ(0,"span"),e._uU(1,"Editing..."),e.qZA())}function Ve(t,a){1&t&&(e.TgZ(0,"span"),e._uU(1,"Loading..."),e.qZA())}function We(t,a){1&t&&(e.TgZ(0,"span"),e._uU(1,"No entry with this id"),e.qZA())}function Xe(t,a){if(1&t){const n=e.EpF();e.TgZ(0,"form",2,3),e.NdJ("ngSubmit",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.facade.editEntry(i.entry))}),e.TgZ(2,"div")(3,"label",4),e._uU(4,"Year"),e.qZA(),e._UZ(5,"input",5),e.qZA(),e.TgZ(6,"div")(7,"label",6),e._uU(8,"Month"),e.qZA(),e._UZ(9,"input",7),e.ALo(10,"date"),e.ALo(11,"monthToDate"),e.qZA(),e.TgZ(12,"div")(13,"label",8),e._uU(14,"Category*"),e.qZA(),e.TgZ(15,"input",9),e.NdJ("ngModelChange",function(i){e.CHM(n);const r=e.oxw();return e.KtG(r.entry.category=i)}),e.qZA()(),e.TgZ(16,"div")(17,"label",10),e._uU(18,"Description*"),e.qZA(),e.TgZ(19,"input",11),e.NdJ("ngModelChange",function(i){e.CHM(n);const r=e.oxw();return e.KtG(r.entry.description=i)}),e.qZA()(),e.TgZ(20,"div")(21,"label",12),e._uU(22,"Value*"),e.qZA(),e.TgZ(23,"finance-fe-value-input",13),e.NdJ("ngModelChange",function(i){e.CHM(n);const r=e.oxw();return e.KtG(r.entry.value=i)}),e.qZA()(),e.TgZ(24,"div")(25,"button",14),e._uU(26," Save "),e.qZA()()()}if(2&t){const n=e.MAs(1),s=e.oxw();e.xp6(5),e.Q6J("ngModel",s.entry.year),e.xp6(4),e.Q6J("ngModel",e.xi3(10,7,e.lcZ(11,10,s.entry.month),"MMMM")),e.xp6(6),e.Q6J("ngModel",s.entry.category),e.xp6(4),e.Q6J("ngModel",s.entry.description),e.xp6(4),e.Q6J("income",s.initialValue>=0)("ngModel",s.entry.value),e.xp6(2),e.Q6J("disabled",n.form.untouched||!n.form.valid)}}const k=[{path:"",component:Ie},{path:"add",component:He},{path:"edit/:entryId",component:(()=>{class t extends f.e${constructor(n,s,i,r,d){super(),this.facade=n,this.toastr=s,this.router=i,this.activatedRoute=r,this.cdr=d,this.entry=void 0,this.loading=!0,this.initialValue=0}ngOnInit(){this.facade.init(),this.facade.resetEdit(),this.subscribeTo(this.facade.editError$,i=>{i&&this.toastr.error("Error editing entry")}),this.subscribeTo(this.facade.edited$,i=>{i&&this.router.navigate(["/summary"])});const n=this.activatedRoute.snapshot.params.entryId,s=this.facade.loaded$.pipe((0,Ge.o)(()=>this.loading),(0,Be.b)(i=>this.loading=!i),(0,ke.w)(()=>this.facade.collection$),(0,g.U)(i=>i.find(r=>r.id===n)));this.subscribeTo(s,i=>{this.entry={...i},this.entry&&(this.initialValue=this.entry.value??0),this.cdr.detectChanges()})}static#e=this.\u0275fac=function(s){return new(s||t)(e.Y36(v),e.Y36(G._W),e.Y36(y.F0),e.Y36(y.gz),e.Y36(e.sBO))};static#t=this.\u0275cmp=e.Xpm({type:t,selectors:[["ng-component"]],features:[e.qOj],decls:6,vars:8,consts:[[4,"ngIf"],["class","max-w-md",3,"ngSubmit",4,"ngIf"],[1,"max-w-md",3,"ngSubmit"],["entryForm","ngForm"],["for","year"],["name","year","type","text","readonly","",3,"ngModel"],["for","month"],["name","month","type","text","readonly","",3,"ngModel"],["for","category"],["name","category","type","text","required","",3,"ngModel","ngModelChange"],["for","description"],["name","description","type","text","required","",3,"ngModel","ngModelChange"],["for","value"],["name","value","required","",3,"income","ngModel","ngModelChange"],["type","submit",1,"btn-primary","mt-2",3,"disabled"]],template:function(s,i){1&s&&(e.YNc(0,ze,2,0,"span",0),e.ALo(1,"async"),e.YNc(2,Ve,2,0,"span",0)(3,We,2,0,"span",0)(4,Xe,27,12,"form",1),e.ALo(5,"async")),2&s&&(e.Q6J("ngIf",e.lcZ(1,4,i.facade.editing$)),e.xp6(2),e.Q6J("ngIf",i.loading),e.xp6(1),e.Q6J("ngIf",!i.entry&&!i.loading),e.xp6(1),e.Q6J("ngIf",!1===e.lcZ(5,6,i.facade.editing$)&&i.entry))},dependencies:[c.O5,u._Y,u.Fj,u.JJ,u.JL,u.Q7,u.On,u.F,B.o,c.Ov,c.uU,F],encapsulation:2,changeDetection:0})}return t})()}];let et=(()=>{class t{static#e=this.\u0275fac=function(s){return new(s||t)};static#t=this.\u0275mod=e.oAB({type:t});static#n=this.\u0275inj=e.cJS({imports:[c.ez,y.Bz.forChild(k),Ne,je,Ke,ve]})}return t})()}}]);