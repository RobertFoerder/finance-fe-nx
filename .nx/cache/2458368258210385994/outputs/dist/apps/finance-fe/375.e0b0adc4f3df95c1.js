"use strict";(self.webpackChunkfinance_fe=self.webpackChunkfinance_fe||[]).push([[375],{2375:(Ut,E,a)=>{a.r(E),a.d(E,{FixedCostsViewsModule:()=>Rt,ROUTES:()=>O});var u=a(6814),g=a(8136),x=a(6884),o=a(4221),N=a(8180);const _=(0,o.PH)("[Fixed-Costs/API] Load fixed costs"),T=(0,o.PH)("[Fixed-Costs/API] Load fixed costs success",(0,o.Ky)()),q=(0,o.PH)("[Fixed-Costs/API] Load fixed costs failure",(0,o.Ky)()),S=(0,o.PH)("[Fixed-Costs] Reset"),v=(0,o.PH)("[Fixed-Costs/API] Add",(0,o.Ky)()),$=(0,o.PH)("[Fixed-Costs/API] Add fixed cost success",(0,o.Ky)()),M=(0,o.PH)("[Fixed-Costs/API] Add fixed cost failure",(0,o.Ky)()),b=(0,o.PH)("[Fixed-Costs] Reset add"),A=(0,o.PH)("[Fixed-Costs/API] Delete",(0,o.Ky)()),J=(0,o.PH)("[Fixed-Costs/API] Delete fixed cost success",(0,o.Ky)()),P=(0,o.PH)("[Fixed-Costs/API] Delete fixed cost failure",(0,o.Ky)()),Y=(0,o.PH)("[Fixed-Costs] Reset delete"),y=(0,o.PH)("[Fixed-Costs/API] Edit",(0,o.Ky)()),R=(0,o.PH)("[Fixed-Costs/API] Edit fixed cost success",(0,o.Ky)()),U=(0,o.PH)("[Fixed-Costs/API] Edit fixed cost failure",(0,o.Ky)()),I=(0,o.PH)("[Fixed-Costs] Reset edit");var Q=a(6293);const L="fixed-costs",C=(0,Q.H)(),G=C.getInitialState({readRequestStatus:"initial",addRequestStatus:"initial",deleteRequestStatus:"initial",editRequestStatus:"initial",loadError:void 0,addError:void 0,deleteError:void 0,editError:void 0}),D=(0,o.Lq)(G,(0,o.on)(_,e=>({...e,readRequestStatus:"pending",loadError:void 0})),(0,o.on)(T,(e,{fixedCosts:r})=>C.setAll(r,{...e,readRequestStatus:"successful"})),(0,o.on)(q,(e,{error:r})=>({...e,loadError:r,readRequestStatus:"failed"})),(0,o.on)(v,e=>({...e,addRequestStatus:"pending",addError:void 0})),(0,o.on)($,(e,{fixedCost:r})=>C.setOne(r,{...e,addRequestStatus:"successful"})),(0,o.on)(M,(e,{error:r})=>({...e,addRequestStatus:"failed",addError:r})),(0,o.on)(A,e=>({...e,deleteRequestStatus:"pending",deleteError:void 0})),(0,o.on)(J,(e,{id:r})=>C.removeOne(r,{...e,deleteRequestStatus:"successful"})),(0,o.on)(P,(e,{error:r})=>({...e,deleteRequestStatus:"failed",deleteError:r})),(0,o.on)(y,e=>({...e,editRequestStatus:"pending",editError:void 0})),(0,o.on)(R,(e,{fixedCost:r})=>C.upsertOne(r,{...e,editRequestStatus:"successful"})),(0,o.on)(U,(e,{error:r})=>({...e,editRequestStatus:"failed",editError:r})),(0,o.on)(S,e=>({...e,loadError:void 0,readRequestStatus:"initial"})),(0,o.on)(b,e=>({...e,addError:void 0,addRequestStatus:"initial"})),(0,o.on)(Y,e=>({...e,deleteError:void 0,deleteRequestStatus:"initial"})),(0,o.on)(I,e=>({...e,editError:void 0,editRequestStatus:"initial"})));function B(e,r){return D(e,r)}const f=(0,o.ZF)(L),{selectAll:j,selectEntities:z}=C.getSelectors(),V=(0,o.P1)(f,e=>"pending"===e.readRequestStatus),W=(0,o.P1)(f,e=>"successful"===e.readRequestStatus),X=(0,o.P1)(f,e=>e.loadError),k=(0,o.P1)(f,e=>j(e)),tt=(0,o.P1)(f,e=>z(e)),et=(0,o.P1)(f,e=>"pending"===e.deleteRequestStatus),st=(0,o.P1)(f,e=>e.deleteError),it=(0,o.P1)(f,e=>"pending"===e.addRequestStatus),ot=(0,o.P1)(f,e=>"successful"===e.addRequestStatus),nt=(0,o.P1)(f,e=>e.addError),dt=(0,o.P1)(f,e=>"pending"===e.editRequestStatus),rt=(0,o.P1)(f,e=>"successful"===e.editRequestStatus),at=(0,o.P1)(f,e=>e.editError);var t=a(9212);let m=(()=>{class e{constructor(s){this.store=s,this.loading$=this.store.pipe((0,o.Ys)(V)),this.loaded$=this.store.pipe((0,o.Ys)(W)),this.collection$=this.store.pipe((0,o.Ys)(k)),this.entities$=this.store.pipe((0,o.Ys)(tt)),this.loadError$=this.store.pipe((0,o.Ys)(X)),this.deleting$=this.store.pipe((0,o.Ys)(et)),this.deleteError$=this.store.pipe((0,o.Ys)(st)),this.adding$=this.store.pipe((0,o.Ys)(it)),this.added$=this.store.pipe((0,o.Ys)(ot)),this.addError$=this.store.pipe((0,o.Ys)(nt)),this.editing$=this.store.pipe((0,o.Ys)(dt)),this.edited$=this.store.pipe((0,o.Ys)(rt)),this.editError$=this.store.pipe((0,o.Ys)(at))}init(){this.loaded$.pipe((0,N.q)(1)).subscribe(s=>{s||this.store.dispatch(_())})}resetFixedCosts(){this.store.dispatch(S())}resetAdd(){this.store.dispatch(b())}resetDelete(){this.store.dispatch(Y())}resetEdit(){this.store.dispatch(I())}addFixedCost(s){this.store.dispatch(v({fixedCost:s}))}editFixedCost(s){s.id&&this.store.dispatch(y({id:s.id,fixedCost:s}))}deleteFixedCost(s){s&&this.store.dispatch(A({id:s}))}static#t=this.\u0275fac=function(n){return new(n||e)(t.LFG(o.yh))};static#e=this.\u0275prov=t.Yz7({token:e,factory:e.\u0275fac})}return e})();var p=a(3109),ct=a(3536),F=a(7566),h=a(7398);let lt=(()=>{class e{constructor(s,n){this.actions$=s,this.service=n,this.load$=(0,p.GW)(()=>this.actions$.pipe((0,p.l4)(_),(0,F.he)({run:()=>this.service.getFixedCost().pipe((0,h.U)(i=>T({fixedCosts:i}))),onError:(i,d)=>q({error:(0,x.xs)(d)})}))),this.add$=(0,p.GW)(()=>this.actions$.pipe((0,p.l4)(v),(0,F.he)({run:({fixedCost:i})=>this.service.postFixedCost(i).pipe((0,h.U)(d=>$({fixedCost:d}))),onError:(i,d)=>M({error:(0,x.xs)(d)})}))),this.delete$=(0,p.GW)(()=>this.actions$.pipe((0,p.l4)(A),(0,F.he)({run:({id:i})=>this.service.deleteFixedCost(i).pipe((0,h.U)(()=>J({id:i}))),onError:(i,d)=>P({error:(0,x.xs)(d)})}))),this.edit$=(0,p.GW)(()=>this.actions$.pipe((0,p.l4)(y),(0,F.he)({run:({id:i,fixedCost:d})=>this.service.putFixedCost(i,d).pipe((0,h.U)(c=>R({fixedCost:c}))),onError:(i,d)=>U({error:(0,x.xs)(d)})})))}static#t=this.\u0275fac=function(n){return new(n||e)(t.LFG(p.eX),t.LFG(ct.ad))};static#e=this.\u0275prov=t.Yz7({token:e,factory:e.\u0275fac})}return e})();var Z=a(1868);let ut=(()=>{class e{static#t=this.\u0275fac=function(n){return new(n||e)};static#e=this.\u0275mod=t.oAB({type:e});static#s=this.\u0275inj=t.cJS({providers:[m],imports:[u.ez,o.Aw.forFeature(L,B),p.sQ.forFeature([lt]),Z.m]})}return e})();var ft=a(4219);function pt(e,r){1&e&&(t.TgZ(0,"span"),t._uU(1,"Loading ..."),t.qZA())}function xt(e,r){1&e&&(t.TgZ(0,"span"),t._uU(1,"Error loading fixed costs..."),t.qZA())}function gt(e,r){1&e&&(t.TgZ(0,"span"),t._uU(1,"Deleting..."),t.qZA())}function Ct(e,r){1&e&&(t.TgZ(0,"span"),t._uU(1,"Error deleting fixed cost..."),t.qZA())}function ht(e,r){if(1&e){const s=t.EpF();t.O4$(),t.kcU(),t.TgZ(0,"div",13)(1,"span"),t._uU(2),t.qZA(),t.TgZ(3,"button",4),t.NdJ("click",function(){const d=t.CHM(s).$implicit,c=t.oxw(3);return t.KtG(c.editFixedCost(d.id))}),t._UZ(4,"img",14),t.qZA(),t.TgZ(5,"button",4),t.NdJ("click",function(){const d=t.CHM(s).$implicit,c=t.oxw(3);return t.KtG(c.deleteFixedCost(d.id,d.description))}),t._UZ(6,"img",15),t.qZA(),t.TgZ(7,"span",16),t._uU(8),t.ALo(9,"currency"),t.qZA()()}if(2&e){const s=r.$implicit;t.xp6(2),t.Oqu(s.description),t.xp6(5),t.ekj("expense",s.value&&s.value<0)("income",s.value&&s.value>0),t.xp6(1),t.hij(" ",t.xi3(9,6,s.value,"EUR")," ")}}function mt(e,r){if(1&e){const s=t.EpF();t.TgZ(0,"div",9)(1,"div",10)(2,"span",11),t._uU(3),t.qZA(),t.TgZ(4,"button",4),t.NdJ("click",function(){const d=t.CHM(s).$implicit,c=t.oxw(2);return t.KtG(c.addFixedCost(d.category))}),t.O4$(),t.TgZ(5,"svg",5)(6,"title"),t._uU(7,"Add"),t.qZA(),t._UZ(8,"path",6),t.qZA()()(),t.YNc(9,ht,10,9,"div",12),t.qZA()}if(2&e){const s=r.$implicit;t.xp6(3),t.Oqu(s.category),t.xp6(6),t.Q6J("ngForOf",s.fixedCosts)}}function Ft(e,r){if(1&e){const s=t.EpF();t.TgZ(0,"div")(1,"div",1)(2,"div",2)(3,"span",3),t._uU(4,"Fixed costs"),t.qZA(),t.TgZ(5,"button",4),t.NdJ("click",function(){t.CHM(s);const i=t.oxw();return t.KtG(i.addFixedCost())}),t.O4$(),t.TgZ(6,"svg",5)(7,"title"),t._uU(8,"Add"),t.qZA(),t._UZ(9,"path",6),t.qZA()()(),t.kcU(),t.TgZ(10,"div",7),t.YNc(11,mt,10,2,"div",8),t.ALo(12,"async"),t.qZA()()()}if(2&e){const s=t.oxw();t.xp6(11),t.Q6J("ngForOf",t.lcZ(12,1,s.fixedCostsGroupedByCategory$))}}let _t=(()=>{class e extends x.e${constructor(s,n,i,d){super(),this.facade=s,this.router=n,this.activatedRoute=i,this.confirmBox=d,this.total=0,this.fixedCostsGroupedByCategory$=this.facade.collection$.pipe((0,h.U)(c=>this.groupFixedCostsByCategory(c)))}ngOnInit(){this.facade.init()}addFixedCost(s){let n=null;s&&(n={category:s}),this.router.navigate(["add"],{relativeTo:this.activatedRoute,queryParams:n})}deleteFixedCost(s,n){this.confirmBox.danger("Delete fixed cost",`Should fixed cost "${n}" really be deleted?`,"Yes","Cancel").subscribe(i=>{i.success&&this.facade.deleteFixedCost(s)})}editFixedCost(s){this.router.navigate(["edit",s],{relativeTo:this.activatedRoute})}groupFixedCostsByCategory(s){const n=[];if(!s)return n;for(const i of s){if(n.some(c=>c.category===i.category))continue;const d=s.filter(c=>c.category===i.category).sort((c,K)=>c.description&&K.description?c.description.localeCompare(K.description.toString()):0);n.push({category:i.category,fixedCosts:d})}return n.sort((i,d)=>i.category&&d.category?i.category.localeCompare(d.category):0)}static#t=this.\u0275fac=function(n){return new(n||e)(t.Y36(m),t.Y36(g.F0),t.Y36(g.gz),t.Y36(ft.jL))};static#e=this.\u0275cmp=t.Xpm({type:e,selectors:[["ng-component"]],features:[t.qOj],decls:12,vars:19,consts:[[4,"ngIf"],[1,"shadow-lg","rounded-md","h-auto","bg-white","flex","flex-col","p-2"],[1,"flex","flex-row","items-center","border-b-0","border-black","border-b-2"],[1,"ml-2","text-lg","font-bold"],[1,"pl-2",3,"click"],["viewBox","0 0 20 20","xmlns","http://www.w3.org/2000/svg",1,"fill-current","h-4","w-4"],["d","M 10 8 L 10 1 L 8 1 L 8 8 l -7 0 l 0 2 L 8 10 l 0 7 l 2 -0 L 10 10 l 7 0 l -0 -2 z"],[1,"pt-4","pb-2","pl-2"],["class","mb-2",4,"ngFor","ngForOf"],[1,"mb-2"],[1,"border-b-2"],[1,"font-bold"],["class","flex",4,"ngFor","ngForOf"],[1,"flex"],["src","/assets/svg/edit.svg",1,"h-4","w-4","mr-2"],["src","/assets/svg/delete.svg",1,"h-4","w-4","mr-2"],[1,"flex-grow","text-right"]],template:function(n,i){1&n&&(t.YNc(0,pt,2,0,"span",0),t.ALo(1,"async"),t.YNc(2,xt,2,0,"span",0),t.ALo(3,"async"),t.YNc(4,gt,2,0,"span",0),t.ALo(5,"async"),t.YNc(6,Ct,2,0,"span",0),t.ALo(7,"async"),t.YNc(8,Ft,13,3,"div",0),t.ALo(9,"async"),t.ALo(10,"async"),t.ALo(11,"async")),2&n&&(t.Q6J("ngIf",t.lcZ(1,5,i.facade.loading$)),t.xp6(2),t.Q6J("ngIf",t.lcZ(3,7,i.facade.loadError$)),t.xp6(2),t.Q6J("ngIf",t.lcZ(5,9,i.facade.deleting$)),t.xp6(2),t.Q6J("ngIf",t.lcZ(7,11,i.facade.deleteError$)),t.xp6(2),t.Q6J("ngIf",!1===t.lcZ(9,13,i.facade.loading$)&&void 0===t.lcZ(10,15,i.facade.loadError$)&&!1===t.lcZ(11,17,i.facade.deleting$)))},dependencies:[u.sg,u.O5,u.Ov,u.H9],encapsulation:2,changeDetection:0})}return e})(),vt=(()=>{class e{static#t=this.\u0275fac=function(n){return new(n||e)};static#e=this.\u0275mod=t.oAB({type:e});static#s=this.\u0275inj=t.cJS({imports:[u.ez]})}return e})();var w=a(8763),l=a(95),H=a(4954);function At(e,r){1&e&&(t.TgZ(0,"span"),t._uU(1,"Adding..."),t.qZA())}function yt(e,r){if(1&e){const s=t.EpF();t.TgZ(0,"form",2,3),t.NdJ("ngSubmit",function(){t.CHM(s);const i=t.oxw();return t.KtG(i.facade.addFixedCost(i.fixedCost))}),t.TgZ(2,"div")(3,"label",4),t._uU(4,"Category*"),t.qZA(),t.TgZ(5,"input",5),t.NdJ("ngModelChange",function(i){t.CHM(s);const d=t.oxw();return t.KtG(d.fixedCost.category=i)}),t.qZA()(),t.TgZ(6,"div")(7,"label",6),t._uU(8,"Description*"),t.qZA(),t.TgZ(9,"input",7),t.NdJ("ngModelChange",function(i){t.CHM(s);const d=t.oxw();return t.KtG(d.fixedCost.description=i)}),t.qZA()(),t.TgZ(10,"div")(11,"label",8),t._uU(12,"Value*"),t.qZA(),t.TgZ(13,"finance-fe-value-input",9),t.NdJ("ngModelChange",function(i){t.CHM(s);const d=t.oxw();return t.KtG(d.fixedCost.value=i)}),t.qZA()(),t.TgZ(14,"div")(15,"button",10),t._uU(16," Add entry "),t.qZA()()()}if(2&e){const s=t.MAs(1),n=t.oxw();t.xp6(5),t.Q6J("ngModel",n.fixedCost.category),t.xp6(4),t.Q6J("ngModel",n.fixedCost.description),t.xp6(4),t.Q6J("ngModel",n.fixedCost.value),t.xp6(2),t.Q6J("disabled",s.form.untouched||!s.form.valid)}}let Zt=(()=>{class e extends x.e${constructor(s,n,i){super(),this.facade=s,this.toastr=n,this.router=i,this.fixedCost={category:"",description:"",value:0}}ngOnInit(){this.facade.resetAdd(),this.subscribeTo(this.facade.addError$,s=>{s&&this.toastr.error("Error adding fixed cost")}),this.subscribeTo(this.facade.added$,s=>{s&&this.router.navigate(["/fixed-costs"])})}static#t=this.\u0275fac=function(n){return new(n||e)(t.Y36(m),t.Y36(w._W),t.Y36(g.F0))};static#e=this.\u0275cmp=t.Xpm({type:e,selectors:[["ng-component"]],features:[t.qOj],decls:4,vars:6,consts:[[4,"ngIf"],["class","max-w-md",3,"ngSubmit",4,"ngIf"],[1,"max-w-md",3,"ngSubmit"],["fixedCostForm","ngForm"],["for","category"],["name","category","type","text","required","",3,"ngModel","ngModelChange"],["for","description"],["name","description","type","text","required","",3,"ngModel","ngModelChange"],["for","value"],["name","value","required","",3,"ngModel","ngModelChange"],["type","submit",1,"btn-primary","mt-2",3,"disabled"]],template:function(n,i){1&n&&(t.YNc(0,At,2,0,"span",0),t.ALo(1,"async"),t.YNc(2,yt,17,4,"form",1),t.ALo(3,"async")),2&n&&(t.Q6J("ngIf",t.lcZ(1,2,i.facade.adding$)),t.xp6(2),t.Q6J("ngIf",!1===t.lcZ(3,4,i.facade.adding$)))},dependencies:[u.O5,l._Y,l.Fj,l.JJ,l.JL,l.Q7,l.On,l.F,H.o,u.Ov],encapsulation:2,changeDetection:0})}return e})(),Et=(()=>{class e{static#t=this.\u0275fac=function(n){return new(n||e)};static#e=this.\u0275mod=t.oAB({type:e});static#s=this.\u0275inj=t.cJS({imports:[u.ez,l.u5,Z.m]})}return e})();var Tt=a(812),qt=a(9397),St=a(4664);function $t(e,r){1&e&&(t.TgZ(0,"span"),t._uU(1,"Editing..."),t.qZA())}function Mt(e,r){1&e&&(t.TgZ(0,"span"),t._uU(1,"Loading..."),t.qZA())}function bt(e,r){1&e&&(t.TgZ(0,"span"),t._uU(1,"No fixed cost with this id"),t.qZA())}function Jt(e,r){if(1&e){const s=t.EpF();t.TgZ(0,"form",2,3),t.NdJ("ngSubmit",function(){t.CHM(s);const i=t.oxw();return t.KtG(i.facade.editFixedCost(i.fixedCost))}),t.TgZ(2,"div")(3,"label",4),t._uU(4,"Category*"),t.qZA(),t.TgZ(5,"input",5),t.NdJ("ngModelChange",function(i){t.CHM(s);const d=t.oxw();return t.KtG(d.fixedCost.category=i)}),t.qZA()(),t.TgZ(6,"div")(7,"label",6),t._uU(8,"Description*"),t.qZA(),t.TgZ(9,"input",7),t.NdJ("ngModelChange",function(i){t.CHM(s);const d=t.oxw();return t.KtG(d.fixedCost.description=i)}),t.qZA()(),t.TgZ(10,"div")(11,"label",8),t._uU(12,"Value*"),t.qZA(),t.TgZ(13,"finance-fe-value-input",9),t.NdJ("ngModelChange",function(i){t.CHM(s);const d=t.oxw();return t.KtG(d.fixedCost.value=i)}),t.qZA()(),t.TgZ(14,"div")(15,"button",10),t._uU(16," Save "),t.qZA()()()}if(2&e){const s=t.MAs(1),n=t.oxw();t.xp6(5),t.Q6J("ngModel",n.fixedCost.category),t.xp6(4),t.Q6J("ngModel",n.fixedCost.description),t.xp6(4),t.Q6J("income",n.initialValue>=0)("ngModel",n.fixedCost.value),t.xp6(2),t.Q6J("disabled",s.form.untouched||!s.form.valid)}}let Pt=(()=>{class e extends x.e${constructor(s,n,i,d,c){super(),this.facade=s,this.toastr=n,this.router=i,this.activatedRoute=d,this.cdr=c,this.fixedCost=void 0,this.loading=!0,this.initialValue=0}ngOnInit(){this.facade.init(),this.facade.resetEdit(),this.subscribeTo(this.facade.editError$,i=>{i&&this.toastr.error("Error adding fixed cost")}),this.subscribeTo(this.facade.edited$,i=>{i&&this.router.navigate(["/fixed-costs"])});const s=this.activatedRoute.snapshot.params.fixedCostId,n=this.facade.loaded$.pipe((0,Tt.o)(()=>this.loading),(0,qt.b)(i=>this.loading=!i),(0,St.w)(()=>this.facade.collection$),(0,h.U)(i=>i.find(d=>d.id===s)));this.subscribeTo(n,i=>{this.fixedCost={...i},this.fixedCost&&(this.initialValue=this.fixedCost.value??0),this.cdr.detectChanges()})}static#t=this.\u0275fac=function(n){return new(n||e)(t.Y36(m),t.Y36(w._W),t.Y36(g.F0),t.Y36(g.gz),t.Y36(t.sBO))};static#e=this.\u0275cmp=t.Xpm({type:e,selectors:[["ng-component"]],features:[t.qOj],decls:6,vars:8,consts:[[4,"ngIf"],["class","max-w-md",3,"ngSubmit",4,"ngIf"],[1,"max-w-md",3,"ngSubmit"],["fixedCostForm","ngForm"],["for","category"],["name","category","type","text","required","",3,"ngModel","ngModelChange"],["for","description"],["name","description","type","text","required","",3,"ngModel","ngModelChange"],["for","value"],["name","value","required","",3,"income","ngModel","ngModelChange"],["type","submit",1,"btn-primary","mt-2",3,"disabled"]],template:function(n,i){1&n&&(t.YNc(0,$t,2,0,"span",0),t.ALo(1,"async"),t.YNc(2,Mt,2,0,"span",0)(3,bt,2,0,"span",0)(4,Jt,17,5,"form",1),t.ALo(5,"async")),2&n&&(t.Q6J("ngIf",t.lcZ(1,4,i.facade.editing$)),t.xp6(2),t.Q6J("ngIf",i.loading),t.xp6(1),t.Q6J("ngIf",!i.fixedCost&&!i.loading),t.xp6(1),t.Q6J("ngIf",!1===t.lcZ(5,6,i.facade.editing$)&&i.fixedCost))},dependencies:[u.O5,l._Y,l.Fj,l.JJ,l.JL,l.Q7,l.On,l.F,H.o,u.Ov],encapsulation:2,changeDetection:0})}return e})(),Yt=(()=>{class e{static#t=this.\u0275fac=function(n){return new(n||e)};static#e=this.\u0275mod=t.oAB({type:e});static#s=this.\u0275inj=t.cJS({imports:[u.ez,l.u5,Z.m]})}return e})();const O=[{path:"",component:_t},{path:"add",component:Zt},{path:"edit/:fixedCostId",component:Pt}];let Rt=(()=>{class e{static#t=this.\u0275fac=function(n){return new(n||e)};static#e=this.\u0275mod=t.oAB({type:e});static#s=this.\u0275inj=t.cJS({imports:[u.ez,g.Bz.forChild(O),vt,Et,Yt,ut]})}return e})()}}]);